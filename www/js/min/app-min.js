var app=angular.module("app",["ngRoute","mgcrea.ngStrap","controllers"]);app.config(["$routeProvider","$httpProvider","$provide",function(t,e,o){t.when("/",{controller:"MainController",templateUrl:"view/home/home.view.html"}).when("/login",{controller:"LoginController",templateUrl:"view/login/login.view.html"}).when("/dashboard",{controller:"DashboardController",templateUrl:"view/dashboard/dashboard.view.html"}).when("/facility/:id",{templateUrl:"view/facility/facility.view.html",controller:"FacilityController"}).when("/task/:id/:facility",{templateUrl:"view/task/task.view.html",controller:"TaskController"}).when("/request-adhoc/:id",{templateUrl:"view/request/request.view.html",controller:"RequestController"}).when("/update-image-task/:id/:facility",{templateUrl:"view/task/update-image.view.html",controller:"TaskUpdateImageController"}).when("/notification",{templateUrl:"view/notification/index.html",controller:"NotificationController"}).when("/view-notification/:id",{templateUrl:"view/notification/view.html",controller:"NotificationViewController"}).when("/logout",{templateUrl:"view/home/home.view.html",controller:"LogoutController"}).otherwise({templateUrl:"404.html"}),e.interceptors.push("authInterceptor"),o.decorator("$controller",function(t){return function(e,o,r,n){return"string"!=typeof e||o.$scope.controllerName||(o.$scope.controllerName=e),t(e,o,r,n)}})}]),app.factory("authInterceptor",function(t,e,o){return{request:function(t){return e.sessionStorage.access_token&&(t.headers.Authorization="Bearer "+e.sessionStorage.access_token),t},responseError:function(e){return 401===e.status&&o.path("/login").replace(),t.reject(e)}}}),app.service("rest",function(t,e,o){return{baseUrl:"http://lph-local.dev-srv.net/php/enpii/16/np_16014_kelle",path:void 0,models:function(){return t.get(this.baseUrl+this.path+location.search)},model:function(){return null!=o.expand?t.get(this.baseUrl+this.path+"/"+o.id+"?expand="+o.expand):t.get(this.baseUrl+this.path+"/"+o.id)},get:function(){return t.get(this.baseUrl+this.path)},postModel:function(e){return t.post(this.baseUrl+this.path,e)},putModel:function(e){return t.put(this.baseUrl+this.path+"/"+o.id,e)},deleteModel:function(){return t["delete"](this.baseUrl+this.path)}}}),app.directive("login",["$http",function(t){return{transclude:!0,link:function(t,e,o){t.isGuest=void 0==window.sessionStorage._auth},template:'<a href="login" ng-if="isGuest">Login</a>'}}]).filter("checkmark",function(){return function(t){return t?"✓":"✘"}}),app.directive("back",["$window",function(t){return{restrict:"A",link:function(e,o,r){o.bind("click",function(){t.history.back()})}}}]),app.run(["$rootScope","$location","Auth",function(t,e,o){t.$on("$routeChangeStart",function(t){o.isLoggedIn()?(console.log("ALLOW"),e.path("/home")):(console.log("DENY"),t.preventDefault(),e.path("/login"))})}]);